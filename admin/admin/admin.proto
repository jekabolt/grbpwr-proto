syntax = "proto3";

package admin;

import "common/archive.proto";
import "common/dict.proto";
import "common/filter.proto";
import "common/hero.proto";
import "common/language.proto";
import "common/media.proto";
import "common/order.proto";
import "common/payment.proto";
import "common/product.proto";
import "common/promo.proto";
import "common/shipment.proto";
import "common/support.proto";
import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";
import "google/type/decimal.proto";

option go_package = "github.com/jekabolt/grbpwr-products-manager/proto/admin;admin";

service AdminService {
  // KEY VALUE DICTIONARY

  // Retrieves a key-value dictionary.
  rpc GetDictionary(GetDictionaryRequest) returns (GetDictionaryResponse) {
    option (google.api.http) = {get: "/api/admin/dictionary"};
  }

  // BUCKET MANAGER

  // UploadContentImage uploads an image to a specific folder with a specified name.
  rpc UploadContentImage(UploadContentImageRequest) returns (UploadContentImageResponse) {
    option (google.api.http) = {
      post: "/api/admin/content/image"
      body: "*"
    };
  }

  // UploadContentVideo uploads a video to a specific folder with a specified name.
  rpc UploadContentVideo(UploadContentVideoRequest) returns (UploadContentVideoResponse) {
    option (google.api.http) = {
      post: "/api/admin/content/video"
      body: "*"
    };
  }

  // DeleteFromBucket deletes objects specified by their keys.
  rpc DeleteFromBucket(DeleteFromBucketRequest) returns (DeleteFromBucketResponse) {
    option (google.api.http) = {delete: "/api/admin/content"};
  }

  // ListObjectsPaged lists all objects in the base folder.
  rpc ListObjectsPaged(ListObjectsPagedRequest) returns (ListObjectsPagedResponse) {
    option (google.api.http) = {get: "/api/admin/content"};
  }

  // PRODUCTS MANAGER

  // Adds a new product or updates an existing one.
  rpc UpsertProduct(UpsertProductRequest) returns (UpsertProductResponse) {
    option (google.api.http) = {
      post: "/api/admin/product/upsert"
      body: "*"
    };
  }

  // Retrieves a paginated list of products.
  rpc GetProductsPaged(GetProductsPagedRequest) returns (GetProductsPagedResponse) {
    option (google.api.http) = {get: "/api/admin/products/paged"};
  }

  // Gets a product by its ID.
  rpc GetProductByID(GetProductByIDRequest) returns (GetProductByIDResponse) {
    option (google.api.http) = {get: "/api/admin/product/{id}"};
  }

  // Deletes a product by its ID.
  rpc DeleteProductByID(DeleteProductByIDRequest) returns (DeleteProductByIDResponse) {
    option (google.api.http) = {delete: "/api/admin/product/{id}"};
  }

  // Updates the stock for a specific product size.
  rpc UpdateProductSizeStock(UpdateProductSizeStockRequest) returns (UpdateProductSizeStockResponse) {
    option (google.api.http) = {
      post: "/api/admin/product/{product_id}/size/{size_id}/updatestock"
      body: "*"
    };
  }

  // Lists stock change history with optional filters.
  rpc ListStockChangeHistory(ListStockChangeHistoryRequest) returns (ListStockChangeHistoryResponse) {
    option (google.api.http) = {get: "/api/admin/stock-change-history"};
  }

  // PROMO MANAGER

  // Adds a new promotional code
  rpc AddPromo(AddPromoRequest) returns (AddPromoResponse) {
    option (google.api.http) = {
      post: "/api/admin/promo/add"
      body: "*"
    };
  }

  // Lists all promotional codes
  rpc ListPromos(ListPromosRequest) returns (ListPromosResponse) {
    option (google.api.http) = {get: "/api/admin/promo/list"};
  }

  // Deletes a specific promotional code
  rpc DeletePromoCode(DeletePromoCodeRequest) returns (DeletePromoCodeResponse) {
    option (google.api.http) = {delete: "/api/admin/promo/{code}/delete"};
  }

  // Disables a specific promotional code
  rpc DisablePromoCode(DisablePromoCodeRequest) returns (DisablePromoCodeResponse) {
    option (google.api.http) = {
      post: "/api/admin/promo/{code}/disable"
      body: "*"
    };
  }

  // ORDER MANAGER

  // Retrieves an order by its ID
  rpc GetOrderByUUID(GetOrderByUUIDRequest) returns (GetOrderByUUIDResponse) {
    option (google.api.http) = {get: "/api/admin/order/{order_uuid}"};
  }

  // Updates shipping information for an order
  rpc SetTrackingNumber(SetTrackingNumberRequest) returns (SetTrackingNumberResponse) {
    option (google.api.http) = {
      post: "/api/admin/orders/{order_uuid}/set-tracking-number"
      body: "*"
    };
  }

  // Retrieves orders by their status payment method or email
  rpc ListOrders(ListOrdersRequest) returns (ListOrdersResponse) {
    option (google.api.http) = {
      post: "/api/admin/orders/list"
      body: "*"
    };
  }

  // Processes a refund for an order
  rpc RefundOrder(RefundOrderRequest) returns (RefundOrderResponse) {
    option (google.api.http) = {
      post: "/api/admin/orders/{order_uuid}/refund"
      body: "*"
    };
  }

  // Marks an order as delivered
  rpc DeliveredOrder(DeliveredOrderRequest) returns (DeliveredOrderResponse) {
    option (google.api.http) = {
      post: "/api/admin/orders/{order_uuid}/delivered"
      body: "*"
    };
  }

  // Retrieves business metrics for a period with optional comparison period
  rpc GetBusinessMetrics(GetBusinessMetricsRequest) returns (GetBusinessMetricsResponse) {
    option (google.api.http) = {get: "/api/admin/metrics"};
  }

  // Cancels an order
  rpc CancelOrder(CancelOrderRequest) returns (CancelOrderResponse) {
    option (google.api.http) = {
      post: "/api/admin/orders/{order_uuid}/cancel"
      body: "*"
    };
  }

  // Adds a comment to an order
  rpc AddOrderComment(AddOrderCommentRequest) returns (AddOrderCommentResponse) {
    option (google.api.http) = {
      post: "/api/admin/orders/{order_uuid}/comment"
      body: "*"
    };
  }

  // HERO MANAGER

  // Adds a new hero
  rpc AddHero(AddHeroRequest) returns (AddHeroResponse) {
    option (google.api.http) = {
      post: "/api/admin/hero/add"
      body: "*"
    };
  }

  // ARCHIVE MANAGER

  // AddArchive creates a new archive.
  rpc AddArchive(AddArchiveRequest) returns (AddArchiveResponse) {
    option (google.api.http) = {
      post: "/api/admin/archive/add"
      body: "*"
    };
  }

  rpc UpdateArchive(UpdateArchiveRequest) returns (UpdateArchiveResponse) {
    option (google.api.http) = {
      post: "/api/admin/archive/update"
      body: "*"
    };
  }

  // DeleteArchiveById deletes an archive by ID.
  rpc DeleteArchiveById(DeleteArchiveByIdRequest) returns (DeleteArchiveByIdResponse) {
    option (google.api.http) = {delete: "/api/admin/archive/{id}"};
  }

  rpc GetArchiveByID(GetArchiveByIDRequest) returns (GetArchiveByIDResponse) {
    option (google.api.http) = {get: "/api/admin/archive/{id}"};
  }

  // SETTINGS

  rpc UpdateSettings(UpdateSettingsRequest) returns (UpdateSettingsResponse) {
    option (google.api.http) = {
      post: "/api/admin/settings/update"
      body: "*"
    };
  }

  // AddShipmentCarrier adds a new shipping carrier.
  rpc AddShipmentCarrier(AddShipmentCarrierRequest) returns (AddShipmentCarrierResponse) {
    option (google.api.http) = {
      post: "/api/admin/settings/shipment-carrier/add"
      body: "*"
    };
  }

  // UpdateShipmentCarrier updates an existing shipping carrier.
  rpc UpdateShipmentCarrier(UpdateShipmentCarrierRequest) returns (UpdateShipmentCarrierResponse) {
    option (google.api.http) = {
      post: "/api/admin/settings/shipment-carrier/update"
      body: "*"
    };
  }

  // DeleteShipmentCarrier deletes a shipping carrier by ID.
  rpc DeleteShipmentCarrier(DeleteShipmentCarrierRequest) returns (DeleteShipmentCarrierResponse) {
    option (google.api.http) = {delete: "/api/admin/settings/shipment-carrier/{id}"};
  }

  // SUPPORT MANAGER
  // Order matters: literal paths (paged, case) must be registered after {id} wildcard
  // so they're checked first (grpc-gateway prepends handlers, last-registered = first-checked)

  rpc GetSupportTicketById(GetSupportTicketByIdRequest) returns (GetSupportTicketByIdResponse) {
    option (google.api.http) = {get: "/api/admin/support/tickets/{id}"};
  }

  rpc GetSupportTicketByCaseNumber(GetSupportTicketByCaseNumberRequest) returns (GetSupportTicketByCaseNumberResponse) {
    option (google.api.http) = {get: "/api/admin/support/tickets/case/{case_number}"};
  }

  rpc GetSupportTicketsPaged(GetSupportTicketsPagedRequest) returns (GetSupportTicketsPagedResponse) {
    option (google.api.http) = {get: "/api/admin/support/tickets/paged"};
  }

  rpc UpdateSupportTicketStatus(UpdateSupportTicketStatusRequest) returns (UpdateSupportTicketStatusResponse) {
    option (google.api.http) = {
      post: "/api/admin/support/tickets/{id}/update-status"
      body: "*"
    };
  }

  rpc UpdateSupportTicket(UpdateSupportTicketRequest) returns (UpdateSupportTicketResponse) {
    option (google.api.http) = {
      post: "/api/admin/support/tickets/{id}/update"
      body: "*"
    };
  }
}

// DICITONARY

message GetDictionaryRequest {}

message GetDictionaryResponse {
  common.Dictionary dictionary = 1;
  common.CurrencyMap rates = 2;
}

// MEDIA MANAGER

message UploadContentImageRequest {
  string raw_b64_image = 1;
}

message UploadContentImageResponse {
  common.MediaFull media = 1;
}

message UploadContentVideoRequest {
  bytes raw = 1;
  string content_type = 4;
}

message UploadContentVideoResponse {
  common.MediaFull media = 1;
}

message ListObjectsPagedRequest {
  int32 limit = 1;
  int32 offset = 2;
  common.OrderFactor order_factor = 4;
}

message ListObjectsPagedResponse {
  repeated common.MediaFull list = 1;
}

message DeleteFromBucketRequest {
  int32 id = 1;
}

message DeleteFromBucketResponse {}

// PRODUCTS MANAGER

message UpsertProductRequest {
  int32 id = 1;
  common.ProductNew product = 2;
}

message UpsertProductResponse {
  int32 id = 1;
}

message GetProductsPagedRequest {
  int32 limit = 1;
  int32 offset = 2;
  repeated common.SortFactor sort_factors = 3;
  common.OrderFactor order_factor = 4;
  common.FilterConditions filter_conditions = 5;
  bool show_hidden = 6;
}

message GetProductsPagedResponse {
  repeated common.Product products = 1;
}

message GetProductByIDRequest {
  int32 id = 1;
}

message GetProductByIDResponse {
  common.ProductFull product = 1;
}

message DeleteProductByIDRequest {
  int32 id = 1;
}

message DeleteProductByIDResponse {}

message UpdateProductSizeStockRequest {
  int32 product_id = 1;
  int32 size_id = 2;
  int32 quantity = 3;
}

message UpdateProductSizeStockResponse {}

message ListStockChangeHistoryRequest {
  google.protobuf.Timestamp date_from = 1;
  google.protobuf.Timestamp date_to = 2; // inclusive
  int32 product_id = 3;
  optional int32 size_id = 4; // Optional: filter by size
  common.StockChangeSource source = 5;
  int32 limit = 6; // 0 = return all records
  int32 offset = 7;
  optional common.OrderFactor order_factor = 8; // Optional: default DESC (newest first)
}

message ListStockChangeHistoryResponse {
  repeated common.StockChange changes = 1;
  int32 total = 2;
}

message DeleteProductMediaRequest {
  int32 product_id = 1;
  int32 media_id = 2;
}

message DeleteProductMediaResponse {}

// PROMO MANAGER

message AddPromoRequest {
  common.PromoCodeInsert promo = 1;
}
message AddPromoResponse {}

message ListPromosRequest {
  int32 limit = 1;
  int32 offset = 2;
  common.OrderFactor order_factor = 3;
}

message ListPromosResponse {
  repeated common.PromoCode promo_codes = 1;
}

message DeletePromoCodeRequest {
  string code = 1;
}
message DeletePromoCodeResponse {}

message DisablePromoCodeRequest {
  string code = 1;
}
message DisablePromoCodeResponse {}

// ORDER MANAGER

message GetOrderByUUIDRequest {
  string order_uuid = 1;
}

message GetOrderByUUIDResponse {
  common.OrderFull order = 1;
}

message SetTrackingNumberRequest {
  string order_uuid = 1;
  string tracking_code = 2;
}

message SetTrackingNumberResponse {}

message ListOrdersRequest {
  common.OrderStatusEnum status = 1;
  common.PaymentMethodNameEnum payment_method = 2;
  string email = 3;
  int32 order_id = 4;
  string order_uuid = 5; // filter by order UUID
  int32 limit = 6;
  int32 offset = 7;
  common.OrderFactor order_factor = 8;
}

message ListOrdersResponse {
  repeated common.Order orders = 1;
}

enum MetricsGranularity {
  METRICS_GRANULARITY_UNSPECIFIED = 0; // defaults to day
  METRICS_GRANULARITY_DAY = 1;
  METRICS_GRANULARITY_WEEK = 2;
  METRICS_GRANULARITY_MONTH = 3;
}

enum CompareMode {
  COMPARE_MODE_UNSPECIFIED = 0;
  COMPARE_MODE_NONE = 1;
  COMPARE_MODE_PREVIOUS_PERIOD = 2; // same length, immediately before
  COMPARE_MODE_SAME_PERIOD_LAST_YEAR = 3;
}

message GetBusinessMetricsRequest {
  string period = 1; // "7d", "30d", "90d" or ISO8601 duration (e.g. P7D)
  google.protobuf.Timestamp end_at = 2; // defaults to now; period end (inclusive)
  CompareMode compare_mode = 3;
}

message GetBusinessMetricsResponse {
  BusinessMetrics metrics = 1;
}

message BusinessMetrics {
  TimeRange period = 1;
  TimeRange compare_period = 2;

  MetricWithComparison revenue = 3;
  MetricWithComparison orders_count = 4;
  MetricWithComparison avg_order_value = 5;
  MetricWithComparison items_per_order = 25;
  MetricWithComparison refund_rate = 6;
  MetricWithComparison promo_usage_rate = 7;
  MetricWithComparison gross_revenue = 39;
  MetricWithComparison total_refunded = 40;
  MetricWithComparison total_discount = 41;

  repeated GeographyMetric revenue_by_country = 8;
  repeated GeographyMetric revenue_by_city = 9;
  repeated RegionMetric revenue_by_region = 26;
  repeated GeographyMetric avg_order_by_country = 10;

  repeated CurrencyMetric revenue_by_currency = 27;
  repeated PaymentMethodMetric revenue_by_payment_method = 42;

  repeated ProductMetric top_products_by_revenue = 11;
  repeated ProductMetric top_products_by_quantity = 12;
  repeated CategoryMetric revenue_by_category = 13;
  repeated CrossSellPair cross_sell_pairs = 14;

  MetricWithComparison new_subscribers = 15;
  MetricWithComparison repeat_customers_rate = 16;
  MetricWithComparison avg_orders_per_customer = 17;
  MetricWithComparison avg_days_between_orders = 18;
  CLVStats clv_distribution = 19;

  repeated PromoMetric revenue_by_promo = 20;
  repeated StatusCount orders_by_status = 21;

  repeated TimeSeriesPoint revenue_by_day = 22;
  repeated TimeSeriesPoint orders_by_day = 23;
  repeated TimeSeriesPoint subscribers_by_day = 24;
  repeated TimeSeriesPoint gross_revenue_by_day = 28;
  repeated TimeSeriesPoint refunds_by_day = 29;
  repeated TimeSeriesPoint avg_order_value_by_day = 30;
  repeated TimeSeriesPoint units_sold_by_day = 31;
  repeated TimeSeriesPoint new_customers_by_day = 43;
  repeated TimeSeriesPoint returning_customers_by_day = 44;
  repeated TimeSeriesPoint shipped_by_day = 45;
  repeated TimeSeriesPoint delivered_by_day = 46;
  repeated TimeSeriesPoint revenue_by_day_compare = 32;
  repeated TimeSeriesPoint orders_by_day_compare = 33;
  repeated TimeSeriesPoint subscribers_by_day_compare = 34;
  repeated TimeSeriesPoint gross_revenue_by_day_compare = 35;
  repeated TimeSeriesPoint refunds_by_day_compare = 36;
  repeated TimeSeriesPoint avg_order_value_by_day_compare = 37;
  repeated TimeSeriesPoint units_sold_by_day_compare = 38;
  repeated TimeSeriesPoint new_customers_by_day_compare = 47;
  repeated TimeSeriesPoint returning_customers_by_day_compare = 48;
  repeated TimeSeriesPoint shipped_by_day_compare = 49;
  repeated TimeSeriesPoint delivered_by_day_compare = 50;

  // GA4 Traffic & Engagement
  MetricWithComparison sessions = 51;
  MetricWithComparison users = 52;
  MetricWithComparison new_users = 53;
  MetricWithComparison page_views = 54;
  MetricWithComparison bounce_rate = 55;
  MetricWithComparison avg_session_duration = 56;
  MetricWithComparison pages_per_session = 57;
  MetricWithComparison conversion_rate = 58;
  MetricWithComparison revenue_per_session = 59;

  repeated GeographySessionMetric sessions_by_country = 60;
  repeated ProductViewMetric top_products_by_views = 61;
  repeated TrafficSourceMetric traffic_by_source = 62;
  repeated DeviceMetric traffic_by_device = 63;

  repeated TimeSeriesPoint sessions_by_day = 64;
  repeated TimeSeriesPoint users_by_day = 65;
  repeated TimeSeriesPoint page_views_by_day = 66;
  repeated TimeSeriesPoint conversion_rate_by_day = 67;
  repeated TimeSeriesPoint sessions_by_day_compare = 68;
  repeated TimeSeriesPoint users_by_day_compare = 69;
  repeated TimeSeriesPoint page_views_by_day_compare = 70;
  repeated TimeSeriesPoint conversion_rate_by_day_compare = 71;
}

message PaymentMethodMetric {
  string payment_method = 1;
  google.type.Decimal value = 2;
  int32 count = 3;
}

message TimeRange {
  google.protobuf.Timestamp from = 1;
  google.protobuf.Timestamp to = 2;
}

message MetricWithComparison {
  google.type.Decimal value = 1;
  google.type.Decimal compare_value = 2;
  double change_pct = 3;
}

message GeographyMetric {
  string country = 1;
  string state = 2;
  string city = 3;
  google.type.Decimal value = 4;
  google.type.Decimal compare_value = 5;
  int32 count = 6;
  int32 compare_count = 7;
}

message RegionMetric {
  string region = 1;
  google.type.Decimal value = 2;
  int32 count = 3;
}

message CurrencyMetric {
  string currency = 1;
  google.type.Decimal value = 2;
  int32 count = 3;
}

message ProductMetric {
  int32 product_id = 1;
  string product_name = 2;
  string brand = 3;
  google.type.Decimal value = 4;
  int32 count = 5;
}

message CategoryMetric {
  int32 category_id = 1;
  string category_name = 2;
  google.type.Decimal value = 3;
  int32 count = 4;
}

message CrossSellPair {
  int32 product_a_id = 1;
  int32 product_b_id = 2;
  string product_a_name = 3;
  string product_b_name = 4;
  int32 count = 5;
}

message PromoMetric {
  string promo_code = 1;
  int32 orders_count = 2;
  google.type.Decimal revenue = 3;
  google.type.Decimal avg_discount = 4;
}

message StatusCount {
  string status_name = 1;
  int32 count = 2;
}

message CLVStats {
  google.type.Decimal mean = 1;
  google.type.Decimal median = 2;
  google.type.Decimal p90 = 3;
}

message TimeSeriesPoint {
  google.protobuf.Timestamp date = 1;
  google.type.Decimal value = 2;
  int32 count = 3;
}

message ProductViewMetric {
  int32 product_id = 1;
  string product_name = 2;
  string brand = 3;
  int32 page_views = 4;
  int32 sessions = 5;
  int32 add_to_carts = 6;
  int32 purchases = 7;
  double conversion_rate = 8;
}

message TrafficSourceMetric {
  string source = 1;
  string medium = 2;
  int32 sessions = 3;
  int32 users = 4;
  google.type.Decimal revenue = 5;
}

message DeviceMetric {
  string device_category = 1;
  int32 sessions = 2;
  int32 users = 3;
  double conversion_rate = 4;
}

message GeographySessionMetric {
  string country = 1;
  string state = 2;
  string city = 3;
  int32 sessions = 4;
  int32 users = 5;
}

message RefundOrderRequest {
  string order_uuid = 1;
  // Only used when status is PendingReturn. Empty = full refund. Non-empty = partial refund for specified order_item IDs.
  repeated int32 order_item_ids = 2;
  // Optional reason for the refund (stored in order for audit).
  string reason = 3;
}

message RefundOrderResponse {}

message DeliveredOrderRequest {
  string order_uuid = 1;
}

message DeliveredOrderResponse {}

message CancelOrderRequest {
  string order_uuid = 1;
}

message CancelOrderResponse {}

message AddOrderCommentRequest {
  string order_uuid = 1;
  string comment = 2;
}

message AddOrderCommentResponse {}

// HERO MANAGER

message AddHeroRequest {
  common.HeroFullInsert hero = 1;
}

message AddHeroResponse {}

// ARCHIVE MANAGER

message AddArchiveRequest {
  common.ArchiveInsert archive_insert = 1;
}

message AddArchiveResponse {
  int32 id = 1;
}

message UpdateArchiveRequest {
  int32 id = 1;
  common.ArchiveInsert archive_insert = 2;
}

message GetArchiveByIDRequest {
  int32 id = 1;
}

message GetArchiveByIDResponse {
  common.ArchiveFull archive = 1;
}

message UpdateArchiveResponse {}

message DeleteArchiveByIdRequest {
  int32 id = 1;
}

message DeleteArchiveByIdResponse {}

// SETTINGS

message UpdateSettingsRequest {
  repeated ShipmentCarrierAllowancePrice shipment_carriers = 1;
  repeated PaymentMethodAllowance payment_methods = 2;
  bool site_available = 3;
  int32 max_order_items = 4;
  bool big_menu = 5;
  common.Announce announce = 6;
  int32 order_expiration_seconds = 7; // 0 = use payment handler default
  map<string, google.type.Decimal> complimentary_shipping_prices = 8; // Map of currency code to complimentary shipping threshold (e.g., "EUR" -> 100.00)
  bool is_prod = 9; // true = prod Stripe (CARD), false = test Stripe (CARD_TEST)
}

message UpdateSettingsResponse {}

message ShipmentCarrierAllowancePrice {
  string carrier = 1;
  bool allow = 2;
  map<string, google.type.Decimal> prices = 3; // Map of currency code to price (e.g., "EUR" -> price)
}

message AddShipmentCarrierRequest {
  string carrier = 1;
  map<string, google.type.Decimal> prices = 2; // EUR, USD, GBP, JPY, CNY, KRW required
  string tracking_url = 3;
  string expected_delivery_time = 4;
  string description = 5;
  repeated common.ShippingRegion allowed_regions = 6; // empty = global
  bool allowed = 7;
}

message AddShipmentCarrierResponse {
  int32 id = 1;
}

message UpdateShipmentCarrierRequest {
  int32 id = 1;
  string carrier = 2;
  map<string, google.type.Decimal> prices = 3;
  string tracking_url = 4;
  string expected_delivery_time = 5;
  string description = 6;
  repeated common.ShippingRegion allowed_regions = 7;
  bool allowed = 8;
}

message UpdateShipmentCarrierResponse {}

message DeleteShipmentCarrierRequest {
  int32 id = 1;
}

message DeleteShipmentCarrierResponse {}

message PaymentMethodAllowance {
  common.PaymentMethodNameEnum payment_method = 1;
  bool allow = 2;
}

// SUPPORT MANAGER

message GetSupportTicketsPagedRequest {
  int32 limit = 1;
  int32 offset = 2;
  common.OrderFactor order_factor = 3;
  optional common.SupportTicketStatus status = 4;
  optional string email = 5;
  optional string order_reference = 6;
  optional string topic = 7;
  optional string category = 8;
  optional common.SupportTicketPriority priority = 9;
  optional string date_from = 10; // ISO 8601 format
  optional string date_to = 11; // ISO 8601 format
}

message GetSupportTicketsPagedResponse {
  repeated common.SupportTicket tickets = 1;
  int32 total_count = 2;
}

message GetSupportTicketByIdRequest {
  int32 id = 1;
}

message GetSupportTicketByIdResponse {
  common.SupportTicket ticket = 1;
}

message GetSupportTicketByCaseNumberRequest {
  string case_number = 1;
}

message GetSupportTicketByCaseNumberResponse {
  common.SupportTicket ticket = 1;
}

message UpdateSupportTicketStatusRequest {
  int32 id = 1;
  common.SupportTicketStatus status = 2;
  optional string internal_notes = 3;
}

message UpdateSupportTicketStatusResponse {}

message UpdateSupportTicketRequest {
  int32 id = 1;
  optional common.SupportTicketPriority priority = 2;
  optional string category = 3;
  optional string internal_notes = 4;
}

message UpdateSupportTicketResponse {}
